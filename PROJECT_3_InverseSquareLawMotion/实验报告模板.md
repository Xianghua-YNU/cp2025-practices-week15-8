# 项目：平方反比引力场中的运动 - 实验报告

**学生姓名：** [王鑫筠]
**学号：** [20231050040]
**完成日期：** [2025.6.4]

## 1. 实验目的

（请用1-2句话简要描述本次实验你希望达成的学习目标，例如：通过数值模拟研究不同能量和角动量条件下质点在平方反比引力场中的轨道特性，并验证能量守恒和角动量守恒。）通过数值模拟研究不同能量（E<0、E=0、E>0）和角动量条件下，质点在平方反比引力场中的轨道特性，验证能量守恒与角动量守恒定律，理解引力场中轨道形态与力学量的关联。

## 2. 核心算法与实现

### 2.1 运动方程与数值方法
（简要说明你所使用的运动方程（例如，直角坐标系下的二阶微分方程组）以及你选择的数值求解方法，如 `scipy.integrate.solve_ivp` 及其参数设置，或自行实现的算法如龙格-库塔法等。）
运动方程：采用直角坐标系下的二阶微分方程组描述质点运动。设中心天体位于原点，质点位置 (x,y)、速度 (v_x,v_y)，则加速度由平方反比引力决定：

\begin{cases} 
a_x = -\frac{GM \cdot x}{(x^2 + y^2)^{3/2}} \\ 
a_y = -\frac{GM \cdot y}{(x^2 + y^2)^{3/2}} 
\end{cases}

其中 GM 为引力常数与中心天体质量的乘积，r = \sqrt{x^2 + y^2} 为质点到中心的距离。

- 数值方法：使用  scipy.integrate.solve_ivp  求解常微分方程组（ODEs），选择  RK45  算法（默认自适应步长），设置相对容差  rtol=1e-7 、绝对容差  atol=1e-9  保证精度。


### 2.2 关键函数实现思路
（选择1-2个你认为最核心的函数，例如 `derivatives` 或 `solve_orbit`，用3-5句话描述其实现思路和关键步骤。）

#### `derivatives` 实现思路：

```python
    x,y,vx,vy=state_vector
    r_cubed=(x**2+y**2)**1.5
    if r_cubed < 1e-12:
        ax = -gm_val * x / (1e-12) if x != 0 else 0
        ay = -gm_val * y / (1e-12) if y != 0 else 0
        return [vx, vy, ax, ay]
    ax=-gm_val*x/r_cubed
    ay=-gm_val*y/r_cubed
    return np.array([vx,vy,ax,ay])
```

#### `solve_orbit` 实现思路：

```python
    sol=solve_ivp(
        fun=derivatives,
        t_span=t_span,
        y0=initial_conditions,
        t_eval=t_eval,
        args=(gm_val,),
        method='RK45',
        rtol=1e-7,
        atol=1e-9
    )
    return sol
```

## 3. 实验结果与分析

### 3.1 不同总能量下的轨道

（在此处展示并分析你针对任务 A 生成的轨道图像。确保图像清晰，包含必要的标签和图例。）
![Figure_1](https://github.com/user-attachments/assets/59eb4d2a-28c3-4c7f-b8dd-840a4581cbbb)

**图1：不同能量下的轨道图 (E<0, E=0, E>0)**

```
[如果无法直接嵌入图像，请在此处描述图像内容，并指明图像文件名，例如：
 图像显示了三种能量条件下的轨道：
 - 椭圆轨道 (E = [具体值]): [简要描述形状和特征]
 - 抛物线轨道 (E = [具体值]): [简要描述形状和特征]
 - 双曲线轨道 (E = [具体值]): [简要描述形状和特征]
 中心天体位于原点。
 图像文件名：energy_orbits.png (示例)
]
```
- 图像描述：

- 椭圆轨道（E=-0.5）：闭合曲线，质点绕中心天体周期性运动，长半轴约 2.0，短半轴约 1.5，中心天体位于椭圆焦点。

- 抛物线轨道（E=0）：开放曲线，质点从无穷远处渐近靠近，掠过中心天体后向另一方向逃逸，轨道关于 x 轴对称。

- 双曲线轨道（E=0.5）：开放曲线，两支分别指向不同方向，中心天体位于双曲线焦点，质点高速穿场后逃逸。
**结果分析：**
（简要分析不同能量条件下轨道形状的差异及其物理意义。可以讨论能量与轨道是否束缚的关系。）

**(可选) 能量与角动量守恒验证：**
（如果你进行了能量和角动量随时间变化的计算和绘图，请在此处展示结果，并分析其守恒情况。讨论数值误差对守恒性的影响。）

### 3.2 不同角动量下的椭圆轨道 (E < 0)

（在此处展示并分析你针对任务 B 生成的轨道图像。）
![Figure_2](https://github.com/user-attachments/assets/3001888d-d765-4b9b-b9a6-75727ddccf50)

**图2：固定能量 (E=[具体值])，不同角动量下的椭圆轨道**

```
[如果无法直接嵌入图像，请在此处描述图像内容，并指明图像文件名，例如：
 图像显示了能量 E=[具体值] 时，三个不同角动量 L1, L2, L3 下的椭圆轨道。
 - L1 = [值]: [描述轨道形状，如偏心率]
 - L2 = [值]: [描述轨道形状]
 - L3 = [值]: [描述轨道形状]
 图像文件名：angular_momentum_orbits.png (示例)
]
```

**结果分析：**
（分析角动量大小对椭圆轨道形状（如偏心率、半长轴、半短轴）的影响。角动量如何改变轨道的“扁平”程度？）
- 角动量影响轨道“形状规则性”：角动量越大，椭圆偏心率越小（越接近圆）；角动量为 0 时轨道退化为直线（极端扁椭圆，实际因引力聚焦会坠落中心）。

- 物理意义：角动量反映质点“横向运动”的强弱，横向速度越大（角动量越大），轨道越难被引力“拉扁”，形态更对称。
## 4. 问题与收获

### 4.1遇到的主要问题及解决方法
（列出你在完成项目中遇到的1-2个主要困难或挑战，并说明你是如何思考和解决这些问题的。）

**问题1：**  NameError: name 'r_cubed' is not defined 

**解决方法：** 检查  derivatives  函数，发现漏写 r^3 计算逻辑，补充  r_cubed = (x**2 + y**2)**1.5  后修复。

**问题2：** 轨道模拟出现“异常发散”（能量 E<0 却得到开放轨道）

**解决方法：** 排查初始条件，发现速度方向设置错误（误将径向速度设为横向），修正初始速度分量后轨道恢复闭合。

### 4.2 主要收获与体会
（用3-5句话总结你通过本次实验获得的主要知识、技能或感悟。例如，对轨道力学的理解加深、数值求解ODE的经验、数据可视化的技巧等。）
- 掌握了“数值求解 ODEs + 物理问题建模”的完整流程，理解  scipy.integrate.solve_ivp  的参数设置与应用场景。

- 直观验证了平方反比引力场中“能量-轨道形态”“角动量-轨道形状”的关联，深化了对天体力学守恒律（能量、角动量守恒）的理解。

- 学会通过“问题定位（报错追踪、逻辑排查）→ 代码修正 → 结果验证”解决数值模拟中的典型问题。
## 5. (可选) 思考与展望

（如果你完成了可选任务或有其他深入思考，可以在此部分阐述。）

### 5.1 坐标转换与对称性
（如果你研究了极坐标转换和轨道对称性，请在此处分享你的发现和理解。）

### 5.2 其他思考
（例如，此模型有哪些局限性？如何可以进一步扩展或改进这个项目？真实天体运动与此理想模型的差异等。）

